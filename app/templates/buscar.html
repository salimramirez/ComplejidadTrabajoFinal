{% extends "base.html" %}

{% block title %}Buscar Aeropuertos{% endblock %}

{% block content %}
<h2 class="titulo-buscar">Buscar Aeropuertos</h2>

<div class="formulario-busqueda">
    {% if not seleccion.origen %}
    <h3>Seleccione el Nodo de Origen</h3>
    {% elif not seleccion.destino %}
    <h3>Seleccione el Nodo de Destino</h3>
    <p><strong>Origen Seleccionado:</strong> {{ seleccion.origen }}</p>
    {% endif %}

    <form method="POST" class="form-buscar">
        <input type="hidden" name="modo" value="{{ 'origen' if not seleccion.origen else 'destino' }}">
        <label for="criterio" class="label-buscar">Ciudad o País:</label>
        <input type="text" id="criterio" name="criterio" required class="input-buscar">
        <button type="submit" class="btn-buscar">Buscar</button>
    </form>
</div>

<div class="resultados">
    <h3>Resultados:</h3>
    <form method="POST">
        <input type="hidden" name="modo" value="{{ 'origen' if not seleccion.origen else 'destino' }}">
        <ul class="lista-resultados">
            {% for aeropuerto in resultados %}
            <li class="resultado-item">
                <input type="radio" id="{{ aeropuerto[0] }}" name="aeropuerto" value="{{ aeropuerto[0] }}" required>
                <label for="{{ aeropuerto[0] }}">{{ aeropuerto[0] }} - {{ aeropuerto[1] }} ({{ aeropuerto[2] }}, {{ aeropuerto[3] }})</label>
            </li>
            {% else %}
            <li class="resultado-item vacio">No se encontraron resultados.</li>
            {% endfor %}
        </ul>
        {% if resultados %}
        <button type="submit" class="btn-seleccionar">Seleccionar</button>
        {% endif %}
    </form>
</div>

{% if distancia and ruta %}
<div class="resultado-final">
    <h3>Resultado:</h3>
    <p><strong>Origen:</strong> {{ seleccion.origen }}</p>
    <p><strong>Destino:</strong> {{ seleccion.destino }}</p>
    <p><strong>Distancia:</strong> {{ distancia }} km</p>
    <p><strong>Ruta:</strong> {{ ruta | join(' → ') }}</p>
    <h3>Visualización de la Ruta:</h3>
    <img src="{{ url_for('static', filename='img/ruta_buscar.png') }}" alt="Ruta Mínima" class="imagen-resultado">
    <form method="POST" action="{{ url_for('buscar.reiniciar') }}">
        <button type="submit" class="btn-reiniciar">Reiniciar Búsqueda</button>
    </form>
</div>
{% endif %}
{% endblock %}
